=============================================================================
HOUSE BUILDER SYSTEM - TECHNICAL DOCUMENTATION
=============================================================================

TABLE OF CONTENTS:
1. Floor Area Calculation
2. Cost Estimation System
3. Dimension Tracking
4. Mesh Behavior Documentation
5. Material Estimation Formulas

=============================================================================
1. FLOOR AREA CALCULATION
=============================================================================

The system calculates floor area using the Shoelace Formula (Gauss Area Formula):

Formula:
  Area = 0.5 * |Σ(x_i * z_(i+1) - x_(i+1) * z_i)|

Where:
  - (x_i, z_i) are the coordinates of wall vertices in 2D space
  - The sum iterates through all vertices in the perimeter
  - The result is absolute value to handle clockwise/counterclockwise ordering

Implementation Location: calculatePolygonArea() function

Steps:
1. Collect all wall start and end points that form the building perimeter
2. Order these points in sequence (connected wall segments)
3. Apply the Shoelace formula to calculate enclosed area
4. For multi-floor buildings, calculate separately for each floor

Multi-Floor Logic:
- Each floor has independent walls that form their own perimeter
- Floor 2 must be contained within Floor 1's perimeter (enforced by boundary validation)
- Total built area = Sum of all floor areas (can vary per floor)
- The system visually displays Floor 1 perimeter as reference on Floor 2 canvas

Edge Cases Handled:
- Irregular polygons (non-rectangular buildings)
- L-shaped, trapezoid, and other complex geometries
- Interior walls/rooms don't affect floor area (only perimeter walls count)
- Minimum 3 walls required to form a valid enclosed area

=============================================================================
2. COST ESTIMATION SYSTEM
=============================================================================

The system uses CSV-based material pricing for accurate cost calculations.
All prices are loaded from: public/material-prices.csv

Material Categories and Estimation:

A) CONCRETE (Foundation + Wall Core)
   Volume = (Total Built Area × 0.15m) + (Total Wall Length × Wall Thickness × Wall Height)
   Cost = Volume (m³) × Price per m³ (from CSV)
   
   Where:
   - Total Built Area × 0.15m = Foundation thickness estimate
   - Wall calculations include all walls across all floors

B) STEEL (Reinforcement)
   Weight = (Total Built Area × 25 kg/m²) + (Total Wall Length × 8 kg/m)
   Cost = Weight (kg) × Price per kg (from CSV)
   
   Purpose: Structural reinforcement in concrete and beams

C) BLOCKS (Masonry/Brickwork)
   Count = Total Wall Area × Block Density
   Cost = Block Count × Price per piece (from CSV)
   
   Where:
   - Total Wall Area = Σ(Wall Length × Wall Height) for all walls
   - Block Density = Default 15 blocks/m² (configurable)

D) ROOFING
   Area = Total Built Area × 1.2 (20% overhang factor)
   Cost = Area (m²) × Price per m² (from CSV)
   
   Adjustments by roof type:
   - Flat: Standard calculation
   - Gable: Area × 1.3 (30% overhang for sloped surfaces)
   - Shed: Area × 1.25 (25% overhang)

E) WINDOWS
   Cost = Total Window Area (m²) × Price per m² (from CSV)
   Where: Total Window Area = Σ(Window Width × Window Height)

F) DOORS
   Cost = Door Count × Price per door (from CSV)

G) FLOORING
   Area per floor = Floor polygon area (using Shoelace formula)
   Total Flooring Area = Σ(Floor Area) for all floors
   Cost = Total Area (m²) × Price per m² × Floor Texture Factor
   
   Texture factors:
   - Concrete: 1.0×
   - Wood: 1.5×
   - Tile: 1.2×
   - Marble: 2.0×
   - Carpet: 1.3×

H) WALLS (Internal Surfaces)
   Cost = Total Wall Area × Price per m² (from CSV)
   Total Wall Area = Σ(Wall Length × Wall Height) for all walls

I) LABOR (Percentage of Total Material Cost)
   Labor = (Sum of all material costs) × Labor Percentage (from CSV)

TOTAL PROJECT COST = A + B + C + D + E + F + G + H + I

=============================================================================
3. DIMENSION TRACKING
=============================================================================

The system tracks the following dimensions automatically:

Per Wall:
  - Start Point (X, Z coordinates)
  - End Point (X, Z coordinates)
  - Length = √((End.X - Start.X)² + (End.Z - Start.Z)²)
  - Height (stored in wall properties)
  - Thickness (stored in wall properties)
  - Surface Area = Length × Height

Per Floor:
  - Level (0 for ground, 1 for first floor, etc.)
  - Height (floor-to-ceiling distance)
  - Base Height = Sum of heights of all lower floors
  - Enclosed Area (calculated using Shoelace formula)
  - Boundary = Perimeter points that form the floor outline

Building-Wide:
  - Total Height = Sum of all floor heights + roof height
  - Total Wall Length = Sum of all wall lengths across all floors
  - Total Built Area = Sum of all floor areas
  - Plot Boundary = Maximum 20m × 10m (200 sqm)

Window/Door Tracking:
  - Position along wall (0.0 to 1.0, where 0 is start and 1 is end)
  - Absolute position = Wall Start + (Position × Wall Vector)
  - Width and Height stored in meters
  - Material type tracked per opening

=============================================================================
4. MESH BEHAVIOR DOCUMENTATION
=============================================================================

Wall Mesh (WallMesh Component):
  - Renders 3D wall boxes from 2D wall data
  - Visibility: Can be toggled per floor
  - Selection: Highlights blue when clicked
  - Material: Standard material with wall-specific color
  - Position: From wall.start to wall.end at floorBaseHeight
  - Thickness: Creates depth using wall.thickness property
  - Height: Extends from base to base + wall.height
  - Windows/Doors: Cut into wall surface, positioned along wall length

Floor Mesh (FloorMesh Component):
  - Creates slab covering the enclosed wall perimeter
  - Uses Shoelace-derived polygon points to define floor shape
  - Visibility: Independent of wall visibility (always visible when floor exists)
  - Position: At calculated floorBaseHeight for each floor
  - Texture: Applied with repetition for tiling effect
  - Color: Per-floor customizable color
  - Not affected by interior walls/rooms (only perimeter matters)

Roof Mesh (RoofMesh Component):

  Flat Roof:
    - Single plane covering entire building footprint + overhang
    - Positioned at top of tallest floor
    - Overhang: 0.3m on all sides
    - Rotation: Math.PI/2 to lay flat horizontally

  Gable Roof:
    - Ridge runs parallel to longest building side
    - Two sloped surfaces descending from ridge to walls
    - Triangular gable faces on short ends (A-shaped)
    - Slope angle: 30 degrees (Math.PI / 6)
    - Ridge height: 2.5m above roof base
    - Creates realistic peaked roof appearance

  Shed Roof:
    - Single sloped surface with selectable direction (N/S/E/W)
    - Slope angle: ~22 degrees (Math.PI / 8)
    - High side: Flush with top of raised wall
    - Low side: Slopes down to opposite wall
    - Creates asymmetrical appearance for specific architecture

Floor Perimeter Guide (2D Canvas):
  - Green dashed line showing floor boundary in top-down view
  - Drawn on canvas before walls for visual reference
  - For Floor 2+: Shows both current floor outline and previous floor(s)
  - Helps users align upper floors within lower floor footprint

Window/Door Mesh Behavior:
  - Positioned along walls using parametric positioning (0.0 to 1.0)
  - Glass protrudes outward by 15cm + inward by 8cm
  - Frames rendered separately for visual clarity
  - Handles rendered in gold at 1.0m height from base
  - Sills rendered below glass windows
  - Rotation synchronized with wall orientation

Support Beam Mesh (BeamMesh Component):
  - Vertical cylinders placed at overhang edges
  - Radius: 0.15m (15cm diameter)
  - Material: Steel (metallic gray with metalness/roughness)
  - Height: From floor base to floor top
  - Automatically placed when Floor 2 overhangs Floor 1
  - Position: At corner vertices where overhang begins

Staircase Mesh (StaircaseMesh Component):
  - Multiple geometry types: straight, L-shaped, U-shaped, spiral
  - Straight: Simple box geometry rotated appropriately
  - L-shaped: Two segment boxes at 90-degree angle
  - U-shaped: Three segment boxes forming U pattern
  - Spiral: Multiple small box steps arranged in spiral
  - Position: Anywhere along floor, user-customizable
  - Rotation: User-configurable around Y-axis
  - Connects lower floor top to upper floor base

Railing Mesh (RailingMesh Component):
  - Posts: Vertical boxes 1.0m height, 0.1m × 0.1m cross-section
  - Horizontal bars: 0.05m × 0.05m boxes between posts
  - Spacing: Posts every 1.0m along wall
  - Material: Steel (dark gray with metallic properties)
  - Replaces wall visual when railing mode enabled
  - Per-wall customizable (individual or all Floor 2 walls)

Ground Plane:
  - Green grass texture with grid overlay (0.5m squares)
  - Covers plot area (configurable width/depth)
  - Red dashed line shows plot boundary
  - Provides visual reference for building size/placement
  - Z-position: 0 (base level)

=============================================================================
5. MATERIAL ESTIMATION FORMULA SUMMARY
=============================================================================

Quick Reference:

Wall Area (m²) = Length (m) × Height (m)
Total Wall Area = Σ Wall Area for all walls

Floor Area (m²) = Shoelace Formula on perimeter points
Total Floor Area = Σ Floor Area for all floors

Block Count = Total Wall Area × Blocks Per m² (from CSV)
Steel Weight (kg) = (Floor Area × 25) + (Wall Length × 8)
Concrete Volume (m³) = (Floor Area × 0.15) + (Wall Length × Thickness × Height)

Window Area (m²) = Σ(Width × Height) for all windows
Door Count = Total number of doors

Roof Area (m²) = Floor Area × Roof Factor
  - Flat: 1.2×
  - Gable: 1.3×
  - Shed: 1.25×

Total Cost = Σ (Material Quantity × Unit Price from CSV)

=============================================================================
END OF DOCUMENTATION
=============================================================================
